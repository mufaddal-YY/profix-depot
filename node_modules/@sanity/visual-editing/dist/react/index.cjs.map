{"version":3,"file":"index.cjs","sources":["../../src/ui/History.tsx","../../src/ui/Meta.ts","../../src/util/useDragEvents.ts","../../src/ui/schema/SchemaContext.tsx","../../src/ui/schema/useSchema.ts","../../src/ui/context-menu/contextMenuItems.tsx","../../src/ui/context-menu/ContextMenu.tsx","../../src/util/getLinkHref.ts","../../src/ui/preview/PreviewSnapshotsContext.tsx","../../src/ui/preview/usePreviewSnapshots.ts","../../src/ui/ElementOverlay.tsx","../../src/ui/OverlayDragGroupRect.tsx","../../src/ui/OverlayDragInsertMarker.tsx","../../src/ui/OverlayDragPreview.tsx","../../src/ui/OverlayMinimapPrompt.tsx","../../src/ui/elementsReducer.ts","../../src/ui/overlayStateReducer.ts","../../src/ui/preview/PreviewSnapshotsProvider.tsx","../../src/ui/schema/SchemaProvider.tsx","../../src/ui/shared-state/SharedStateProvider.tsx","../../src/ui/telemetry/TelemetryProvider.tsx","../../src/ui/useController.tsx","../../src/ui/usePerspectiveSync.tsx","../../src/ui/useReportDocuments.ts","../../src/ui/Overlays.tsx","../../src/ui/Refresh.tsx","../../src/ui/useComlink.tsx","../../src/optimistic/state/createSharedListener.ts","../../src/ui/useDatasetMutator.ts","../../src/ui/VisualEditing.tsx"],"sourcesContent":["import {useEffect, type FunctionComponent} from 'react'\nimport type {HistoryAdapter, VisualEditingNode} from '../types'\n\n/**\n * @internal\n */\nexport const History: FunctionComponent<{\n  comlink: VisualEditingNode\n  history?: HistoryAdapter\n}> = (props) => {\n  const {comlink, history} = props\n\n  useEffect(() => {\n    return comlink?.on('presentation/navigate', (data) => {\n      history?.update(data)\n    })\n  }, [comlink, history])\n\n  useEffect(() => {\n    if (history) {\n      return history.subscribe((update) => {\n        update.title = update.title || document.title\n        comlink?.post('visual-editing/navigate', update)\n      })\n    }\n    return\n  }, [comlink, history])\n\n  return null\n}\n","import {useEffect, type FunctionComponent} from 'react'\nimport type {VisualEditingNode} from '../types'\n\n/**\n * @internal\n */\nexport const Meta: FunctionComponent<{\n  comlink: VisualEditingNode\n}> = (props) => {\n  const {comlink} = props\n\n  useEffect(() => {\n    const sendMeta = () => {\n      comlink.post('visual-editing/meta', {title: document.title})\n    }\n\n    const observer = new MutationObserver(([mutation]) => {\n      if (mutation.target.nodeName === 'TITLE') {\n        sendMeta()\n      }\n    })\n\n    observer.observe(document.head, {\n      subtree: true,\n      characterData: true,\n      childList: true,\n    })\n\n    sendMeta()\n\n    return () => observer.disconnect()\n  }, [comlink])\n\n  return null\n}\n","import {at, insert, remove} from '@sanity/mutate'\nimport {get as getFromPath} from '@sanity/util/paths'\nimport {useCallback, useEffect} from 'react'\nimport {useDocuments} from '../react/useDocuments'\nimport type {DragEndEvent, DragInsertPosition} from '../types'\nimport {getArrayItemKeyAndParentPath} from './mutations'\n\n// Finds the node that the drag end event was relative to, and the relative\n// position the new element should be inserted in. If the reference node was\n// \"top\" or \"left\", we insert \"after\". If it was \"bottom\" or \"right\", we insert\n// \"before\".\nfunction getReferenceNodeAndInsertPosition(position: DragInsertPosition) {\n  if (position) {\n    const {top, right, bottom, left} = position\n    if (left || top) {\n      return {node: (left ?? top)!.sanity, position: 'after' as const}\n    } else if (right || bottom) {\n      return {node: (right ?? bottom)!.sanity, position: 'before' as const}\n    }\n  }\n  return undefined\n}\n\nexport function useDragEndEvents(): {\n  dispatchDragEndEvent: (event: DragEndEvent) => void\n} {\n  const {getDocument} = useDocuments()\n\n  useEffect(() => {\n    const handler = (e: CustomEvent<DragEndEvent>) => {\n      const {insertPosition, target, preventInsertDefault} = e.detail\n\n      if (preventInsertDefault) return\n\n      const reference = getReferenceNodeAndInsertPosition(insertPosition)\n      if (reference) {\n        const doc = getDocument(target.id)\n        // We must have access to the document actor in order to perform the\n        // necessary mutations. If this is undefined, something went wrong when\n        // resolving the currently in use documents\n        const {node, position} = reference\n        // Get the key of the element that was dragged\n        const {key: targetKey, hasExplicitKey} = getArrayItemKeyAndParentPath(target)\n        // Get the key of the reference element, and path to the parent array\n        const {path: arrayPath, key: referenceItemKey} = getArrayItemKeyAndParentPath(node)\n        // Don't patch if the keys match, as this means the item was only\n        // dragged to its existing position, i.e. not moved\n        if (arrayPath && referenceItemKey && referenceItemKey !== targetKey) {\n          doc.patch(async ({getSnapshot}) => {\n            const snapshot = await getSnapshot()\n            // Get the current value of the element we dragged, as we will need\n            // to clone this into the new position\n            const elementValue = getFromPath(snapshot, target.path)\n\n            if (hasExplicitKey) {\n              return [\n                // Remove the original dragged item\n                at(arrayPath, remove({_key: targetKey})),\n                // Insert the cloned dragged item into its new position\n                at(arrayPath, insert(elementValue, position, {_key: referenceItemKey})),\n              ]\n            } else {\n              // handle reordering for primitives\n              return [\n                // Remove the original dragged item\n                at(arrayPath, remove(~~targetKey)),\n                // Insert the cloned dragged item into its new position\n                at(\n                  arrayPath,\n                  insert(\n                    elementValue,\n                    position,\n                    // if target key is < reference, each item in the array's index will be one less due to the previous removal\n                    referenceItemKey > targetKey ? ~~referenceItemKey - 1 : ~~referenceItemKey,\n                  ),\n                ),\n              ]\n            }\n          })\n        }\n      }\n    }\n    window.addEventListener('sanity/dragEnd', handler as EventListener)\n    return () => {\n      window.removeEventListener('sanity/dragEnd', handler as EventListener)\n    }\n  }, [getDocument])\n\n  const dispatchDragEndEvent = useCallback((event: DragEndEvent) => {\n    const customEvent = new CustomEvent<DragEndEvent>('sanity/dragEnd', {\n      detail: event,\n      cancelable: true,\n    })\n    window.dispatchEvent(customEvent)\n  }, [])\n\n  return {dispatchDragEndEvent}\n}\n","import type {\n  DocumentSchema,\n  ResolvedSchemaTypeMap,\n  SanityNode,\n  SanityStegaNode,\n  SchemaType,\n  TypeSchema,\n} from '@sanity/presentation-comlink'\nimport {createContext} from 'react'\nimport type {OverlayElementField, OverlayElementParent} from '../../types'\n\nexport interface SchemaContextValue {\n  getField: (node: SanityNode | SanityStegaNode) => {\n    field: OverlayElementField\n    parent: OverlayElementParent\n  }\n  getType: <T extends 'document' | 'type' = 'document'>(\n    node: SanityNode | SanityStegaNode | string,\n    type?: T,\n  ) => T extends 'document' ? DocumentSchema | undefined : TypeSchema | undefined\n  resolvedTypes: ResolvedSchemaTypeMap\n  schema: SchemaType[]\n}\n\nexport const SchemaContext = createContext<SchemaContextValue | null>(null)\n","import {useContext} from 'react'\nimport {SchemaContext, type SchemaContextValue} from './SchemaContext'\n\nexport function useSchema(): SchemaContextValue {\n  const context = useContext(SchemaContext)\n\n  if (!context) {\n    throw new Error('Schema context is missing')\n  }\n\n  return context\n}\n","import {\n  ArrowDownIcon,\n  ArrowUpIcon,\n  CopyIcon,\n  InsertAboveIcon,\n  InsertBelowIcon,\n  PublishIcon,\n  RemoveIcon,\n  SortIcon,\n  UnpublishIcon,\n} from '@sanity/icons'\nimport type {\n  SanityNode,\n  SchemaArrayItem,\n  SchemaNode,\n  SchemaUnionNode,\n  SchemaUnionOption,\n} from '@sanity/presentation-comlink'\nimport type {SchemaType} from '@sanity/types'\nimport {MenuGroup} from '@sanity/ui/_visual-editing'\nimport {type FunctionComponent} from 'react'\nimport type {OptimisticDocument} from '../../optimistic'\nimport {InsertMenu} from '../../overlay-components/components/InsertMenu'\nimport type {ContextMenuNode, OverlayElementField, OverlayElementParent} from '../../types'\nimport {getNodeIcon} from '../../util/getNodeIcon'\nimport {\n  getArrayDuplicatePatches,\n  getArrayInsertPatches,\n  getArrayMovePatches,\n  getArrayRemovePatches,\n} from '../../util/mutations'\n\nexport function getArrayRemoveAction(node: SanityNode, doc: OptimisticDocument): () => void {\n  if (!node.type) throw new Error('Node type is missing')\n  return () =>\n    doc.patch(async ({getSnapshot}) => getArrayRemovePatches(node, (await getSnapshot())!))\n}\n\nfunction getArrayInsertAction(\n  node: SanityNode,\n  doc: OptimisticDocument,\n  insertType: string,\n  position: 'before' | 'after',\n): () => void {\n  if (!node.type) throw new Error('Node type is missing')\n  return () => doc.patch(() => getArrayInsertPatches(node, insertType, position))\n}\n\nfunction getDuplicateAction(node: SanityNode, doc: OptimisticDocument): () => void {\n  if (!node.type) throw new Error('Node type is missing')\n  return () =>\n    doc.patch(async ({getSnapshot}) => getArrayDuplicatePatches(node, (await getSnapshot())!))\n}\n\nexport function getContextMenuItems(context: {\n  doc: OptimisticDocument\n  field: OverlayElementField\n  node: SanityNode\n  parent: OverlayElementParent\n}): Promise<ContextMenuNode[]> {\n  const {node, field, parent, doc} = context\n  if (field?.type === 'arrayItem') {\n    return getContextMenuArrayItems({node, field, doc})\n  }\n  if (parent?.type === 'union') {\n    return getContextMenuUnionItems({node, parent, doc})\n  }\n\n  return Promise.resolve([])\n}\n\nfunction getDuplicateItem(context: {doc: OptimisticDocument; node: SanityNode}) {\n  const {node, doc} = context\n  if (!doc) return []\n  return [\n    {\n      type: 'action' as const,\n      label: 'Duplicate',\n      icon: CopyIcon,\n      action: getDuplicateAction(node, doc),\n      telemetryEvent: 'Visual Editing Context Menu Item Duplicated' as const,\n    },\n  ]\n}\n\nfunction getRemoveItems(context: {doc: OptimisticDocument; node: SanityNode}) {\n  const {node, doc} = context\n  if (!doc) return []\n  return [\n    {\n      type: 'action' as const,\n      label: 'Remove',\n      icon: RemoveIcon,\n      action: getArrayRemoveAction(node, doc),\n      telemetryEvent: 'Visual Editing Context Menu Item Removed' as const,\n    },\n  ]\n}\n\nasync function getMoveItems(\n  context: {\n    doc: OptimisticDocument\n    node: SanityNode\n  },\n  withDivider = true,\n) {\n  const {node, doc} = context\n  if (!doc) return []\n\n  const items: ContextMenuNode[] = []\n  const groupItems: ContextMenuNode[] = []\n\n  const [moveUpPatches, moveDownPatches, moveFirstPatches, moveLastPatches] = await Promise.all([\n    getArrayMovePatches(node, doc, 'previous'),\n    getArrayMovePatches(node, doc, 'next'),\n    getArrayMovePatches(node, doc, 'first'),\n    getArrayMovePatches(node, doc, 'last'),\n  ])\n\n  if (moveFirstPatches.length) {\n    groupItems.push({\n      type: 'action',\n      label: 'To top',\n      icon: PublishIcon,\n      action: () => doc.patch(moveFirstPatches),\n      telemetryEvent: 'Visual Editing Context Menu Item Moved',\n    })\n  }\n  if (moveUpPatches.length) {\n    groupItems.push({\n      type: 'action',\n      label: 'Up',\n      icon: ArrowUpIcon,\n      action: () => doc.patch(moveUpPatches),\n      telemetryEvent: 'Visual Editing Context Menu Item Moved',\n    })\n  }\n  if (moveDownPatches.length) {\n    groupItems.push({\n      type: 'action',\n      label: 'Down',\n      icon: ArrowDownIcon,\n      action: () => doc.patch(moveDownPatches),\n      telemetryEvent: 'Visual Editing Context Menu Item Moved',\n    })\n  }\n  if (moveLastPatches.length) {\n    groupItems.push({\n      type: 'action',\n      label: 'To bottom',\n      icon: UnpublishIcon,\n      action: () => doc.patch(moveLastPatches),\n      telemetryEvent: 'Visual Editing Context Menu Item Moved',\n    })\n  }\n\n  if (groupItems.length) {\n    items.push({\n      type: 'group',\n      label: 'Move',\n      icon: SortIcon,\n      items: groupItems,\n    })\n    if (withDivider) {\n      items.push({type: 'divider'})\n    }\n  }\n\n  return items\n}\n\nasync function getContextMenuArrayItems(context: {\n  doc: OptimisticDocument\n  field: SchemaArrayItem\n  node: SanityNode\n}): Promise<ContextMenuNode[]> {\n  const {node, field, doc} = context\n  const items: ContextMenuNode[] = []\n  items.push(...getDuplicateItem(context))\n  items.push(...getRemoveItems(context))\n  items.push(...(await getMoveItems(context)))\n\n  items.push({\n    type: 'action',\n    label: 'Insert before',\n    icon: InsertAboveIcon,\n    action: getArrayInsertAction(node, doc, field.name, 'before'),\n    telemetryEvent: 'Visual Editing Context Menu Item Inserted',\n  })\n  items.push({\n    type: 'action',\n    label: 'Insert after',\n    icon: InsertBelowIcon,\n    action: getArrayInsertAction(node, doc, field.name, 'after'),\n    telemetryEvent: 'Visual Editing Context Menu Item Inserted',\n  })\n\n  return items\n}\n\nconst InsertMenuWrapper: FunctionComponent<{\n  label: string\n  onSelect: (schemaType: SchemaType) => void\n  parent: SchemaUnionNode<SchemaNode>\n  width: number | undefined\n  boundaryElement: HTMLDivElement | null\n}> = (props) => {\n  const {label, parent, width, onSelect, boundaryElement} = props\n\n  return (\n    <MenuGroup\n      fontSize={1}\n      icon={InsertBelowIcon}\n      padding={2}\n      popover={{\n        arrow: false,\n        constrainSize: true,\n        floatingBoundary: boundaryElement,\n        padding: 0,\n        placement: 'right-start',\n        fallbackPlacements: [\n          'left-start',\n          'right',\n          'left',\n          'right-end',\n          'left-end',\n          'bottom',\n          'top',\n        ],\n        preventOverflow: true,\n        width,\n        __unstable_margins: [4, 4, 4, 4],\n      }}\n      space={2}\n      text={label}\n    >\n      <InsertMenu node={parent} onSelect={onSelect} />\n    </MenuGroup>\n  )\n}\n\nasync function getContextMenuUnionItems(context: {\n  doc: OptimisticDocument\n  node: SanityNode\n  parent: SchemaUnionNode<SchemaNode>\n}): Promise<ContextMenuNode[]> {\n  const {doc, node, parent} = context\n  const items: ContextMenuNode[] = []\n  items.push(...getDuplicateItem(context))\n  items.push(...getRemoveItems(context))\n  items.push(...(await getMoveItems(context)))\n\n  if (parent.options?.insertMenu) {\n    const insertMenuOptions = parent.options.insertMenu || {}\n    const width = insertMenuOptions.views?.some((view) => view.name === 'grid') ? 0 : undefined\n\n    items.push({\n      type: 'custom',\n      component: ({boundaryElement, sendTelemetry}) => {\n        const onSelect = (schemaType: SchemaType) => {\n          const action = getArrayInsertAction(node, doc, schemaType.name, 'before')\n          action()\n\n          sendTelemetry('Visual Editing Context Menu Item Inserted', null)\n        }\n        return (\n          <InsertMenuWrapper\n            label=\"Insert before\"\n            onSelect={onSelect}\n            parent={parent}\n            width={width}\n            boundaryElement={boundaryElement}\n          />\n        )\n      },\n    })\n\n    items.push({\n      type: 'custom',\n      component: ({boundaryElement, sendTelemetry}) => {\n        const onSelect = (schemaType: SchemaType) => {\n          const action = getArrayInsertAction(node, doc, schemaType.name, 'after')\n          action()\n\n          sendTelemetry('Visual Editing Context Menu Item Inserted', null)\n        }\n        return (\n          <InsertMenuWrapper\n            label=\"Insert after\"\n            onSelect={onSelect}\n            parent={parent}\n            width={width}\n            boundaryElement={boundaryElement}\n          />\n        )\n      },\n    })\n  } else {\n    items.push({\n      type: 'group',\n      label: 'Insert before',\n      icon: InsertAboveIcon,\n      items: (\n        parent.of.filter((item) => item.type === 'unionOption') as SchemaUnionOption<SchemaNode>[]\n      ).map((t) => {\n        return {\n          type: 'action' as const,\n          icon: getNodeIcon(t),\n          label: t.name === 'block' ? 'Paragraph' : t.title || t.name,\n          action: getArrayInsertAction(node, doc, t.name, 'before'),\n          telemetryEvent: 'Visual Editing Context Menu Item Inserted',\n        }\n      }),\n    })\n    items.push({\n      type: 'group',\n      label: 'Insert after',\n      icon: InsertBelowIcon,\n      items: (\n        parent.of.filter((item) => item.type === 'unionOption') as SchemaUnionOption<SchemaNode>[]\n      ).map((t) => {\n        return {\n          type: 'action' as const,\n          label: t.name === 'block' ? 'Paragraph' : t.title || t.name,\n          icon: getNodeIcon(t),\n          action: getArrayInsertAction(node, doc, t.name, 'after'),\n          telemetryEvent: 'Visual Editing Context Menu Item Inserted',\n        }\n      }),\n    })\n  }\n\n  return items\n}\n","import {\n  Box,\n  Flex,\n  Menu,\n  MenuDivider,\n  MenuGroup,\n  MenuItem,\n  Popover,\n  Spinner,\n  Stack,\n  Text,\n  type PopoverMargins,\n} from '@sanity/ui/_visual-editing'\nimport {useCallback, useEffect, useMemo, useState, type FunctionComponent} from 'react'\nimport {useDocuments} from '../../react/useDocuments'\nimport type {ContextMenuNode, ContextMenuProps} from '../../types'\nimport {getNodeIcon} from '../../util/getNodeIcon'\nimport {PopoverPortal} from '../PopoverPortal'\nimport {useSchema} from '../schema/useSchema'\nimport {useTelemetry} from '../telemetry/useTelemetry'\nimport {getContextMenuItems} from './contextMenuItems'\n\nconst POPOVER_MARGINS: PopoverMargins = [-4, 4, -4, 4]\n\nfunction ContextMenuItem(props: {\n  node: ContextMenuNode\n  onDismiss?: () => void\n  boundaryElement: HTMLDivElement | null\n}) {\n  const {node, onDismiss, boundaryElement} = props\n  const sendTelemetry = useTelemetry()\n\n  const onClick = useCallback(() => {\n    if (node.type === 'action') {\n      node.action?.()\n      onDismiss?.()\n\n      if (node.telemetryEvent) {\n        sendTelemetry(node.telemetryEvent, null)\n      }\n    }\n  }, [node, onDismiss, sendTelemetry])\n\n  if (node.type === 'divider') {\n    return <MenuDivider />\n  }\n\n  if (node.type === 'action') {\n    return (\n      <MenuItem\n        fontSize={1}\n        hotkeys={node.hotkeys}\n        icon={node.icon}\n        padding={2}\n        space={2}\n        text={node.label}\n        disabled={!node.action}\n        onClick={onClick}\n      />\n    )\n  }\n\n  if (node.type === 'group') {\n    return (\n      <MenuGroup\n        fontSize={1}\n        icon={node.icon}\n        padding={2}\n        // @todo when this PR lands https://github.com/sanity-io/ui/pull/1454\n        // menu={{\n        //   padding: 0,\n        // }}\n        popover={{\n          arrow: false,\n          constrainSize: true,\n          placement: 'right-start',\n          fallbackPlacements: [\n            'left-start',\n            'right',\n            'left',\n            'right-end',\n            'left-end',\n            'bottom',\n            'top',\n          ],\n          preventOverflow: true,\n          __unstable_margins: POPOVER_MARGINS,\n        }}\n        space={2}\n        text={node.label}\n      >\n        {node.items.map((item, itemIndex) => (\n          <ContextMenuItem\n            key={itemIndex}\n            node={item}\n            onDismiss={onDismiss}\n            boundaryElement={boundaryElement}\n          />\n        ))}\n      </MenuGroup>\n    )\n  }\n\n  if (node.type === 'custom') {\n    const {component: Component} = node\n    return <Component boundaryElement={boundaryElement} sendTelemetry={sendTelemetry} />\n  }\n\n  return null\n}\n\nexport const ContextMenu: FunctionComponent<ContextMenuProps> = (props) => {\n  const {\n    node,\n    onDismiss,\n    position: {x, y},\n  } = props\n\n  const [boundaryElement, setBoundaryElement] = useState<HTMLDivElement | null>(null)\n\n  const {getField} = useSchema()\n  const {getDocument} = useDocuments()\n\n  const {field, parent} = getField(node)\n\n  const title = useMemo(() => {\n    return field?.title || field?.name || 'Unknown type'\n  }, [field])\n\n  const [items, setItems] = useState<ContextMenuNode[] | undefined>(undefined)\n\n  useEffect(() => {\n    const fetchContextMenuItems = async () => {\n      const doc = getDocument(node.id)\n      if (!doc) return\n      const items = await getContextMenuItems({node, field, parent, doc})\n      setItems(items)\n    }\n    fetchContextMenuItems()\n  }, [field, node, parent, getDocument])\n\n  const contextMenuReferenceElement = useMemo(() => {\n    return {\n      getBoundingClientRect: () => ({\n        bottom: y,\n        left: x,\n        right: x,\n        top: y,\n        width: 0,\n        height: 0,\n      }),\n    } as HTMLElement\n  }, [x, y])\n\n  const icon = useMemo(() => {\n    return getNodeIcon(field)\n  }, [field])\n\n  return (\n    <PopoverPortal setBoundaryElement={setBoundaryElement} onDismiss={onDismiss}>\n      <Popover\n        __unstable_margins={POPOVER_MARGINS}\n        arrow={false}\n        open\n        placement=\"right-start\"\n        referenceElement={contextMenuReferenceElement}\n        content={\n          <Menu style={{minWidth: 120, maxWidth: 160}}>\n            <Flex gap={2} padding={2}>\n              <Box flex=\"none\">{items ? <Text size={1}>{icon}</Text> : <Spinner size={1} />}</Box>\n\n              <Stack flex={1} space={2}>\n                <Text size={1} weight=\"semibold\">\n                  {items ? title : 'Loading...'}\n                </Text>\n              </Stack>\n            </Flex>\n\n            {items && (\n              <>\n                <MenuDivider />\n                {items.map((item, i) => (\n                  <ContextMenuItem\n                    key={i}\n                    node={item}\n                    onDismiss={onDismiss}\n                    boundaryElement={boundaryElement}\n                  />\n                ))}\n              </>\n            )}\n          </Menu>\n        }\n      >\n        <div\n          key={`${x}-${y}`}\n          style={{\n            position: 'absolute',\n            left: x,\n            top: y,\n          }}\n        />\n      </Popover>\n    </PopoverPortal>\n  )\n}\n","export function getLinkHref(href: string, referer: string): string {\n  try {\n    const parsed = new URL(href, typeof location === 'undefined' ? undefined : location.origin)\n    if (parsed.hash) {\n      const hash = new URL(getLinkHref(parsed.hash.slice(1), referer))\n      return `${parsed.origin}${parsed.pathname}${parsed.search}#${hash.pathname}${hash.search}`\n    }\n    parsed.searchParams.set('preview', referer)\n    return parsed.toString()\n  } catch {\n    return href\n  }\n}\n","import type {PreviewSnapshot} from '@sanity/presentation-comlink'\nimport {createContext} from 'react'\n\nexport type PreviewSnapshotsContextValue = PreviewSnapshot[]\n\nexport const PreviewSnapshotsContext = createContext<PreviewSnapshotsContextValue | null>(null)\n","import {useContext} from 'react'\nimport {PreviewSnapshotsContext, type PreviewSnapshotsContextValue} from './PreviewSnapshotsContext'\n\nexport function usePreviewSnapshots(): PreviewSnapshotsContextValue {\n  const context = useContext(PreviewSnapshotsContext)\n\n  if (!context) {\n    throw new Error('Preview Snapshots context is missing')\n  }\n\n  return context\n}\n","import {createEditUrl, studioPath} from '@sanity/client/csm'\nimport {DocumentIcon, DragHandleIcon} from '@sanity/icons'\nimport {Box, Card, Flex, Text} from '@sanity/ui/_visual-editing'\nimport {pathToUrlString} from '@sanity/visual-editing-csm'\nimport {\n  isValidElement,\n  memo,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  useSyncExternalStore,\n  type CSSProperties,\n  type FunctionComponent,\n  type ReactElement,\n} from 'react'\nimport scrollIntoView from 'scroll-into-view-if-needed'\nimport {styled} from 'styled-components'\nimport {PointerEvents} from '../overlay-components/components/PointerEvents'\nimport type {\n  ElementFocusedState,\n  ElementNode,\n  OverlayComponent,\n  OverlayComponentResolver,\n  OverlayComponentResolverContext,\n  OverlayRect,\n  SanityNode,\n  SanityStegaNode,\n} from '../types'\nimport {getLinkHref} from '../util/getLinkHref'\nimport {usePreviewSnapshots} from './preview/usePreviewSnapshots'\nimport {useSchema} from './schema/useSchema'\n\nconst isReactElementOverlayComponent = (\n  component:\n    | OverlayComponent\n    | {component: OverlayComponent; props?: Record<string, unknown>}\n    | Array<OverlayComponent | {component: OverlayComponent; props?: Record<string, unknown>}>\n    | ReactElement,\n): component is React.JSX.Element => {\n  return isValidElement(component)\n}\n\nexport interface ElementOverlayProps {\n  componentResolver?: OverlayComponentResolver\n  draggable: boolean\n  element: ElementNode\n  focused: ElementFocusedState\n  hovered: boolean\n  isDragging: boolean\n  node: SanityNode | SanityStegaNode\n  rect: OverlayRect\n  showActions: boolean\n  wasMaybeCollapsed: boolean\n  enableScrollIntoView: boolean\n}\n\nconst Root = styled(Card)`\n  background-color: var(--overlay-bg);\n  border-radius: 3px;\n  pointer-events: none;\n  position: absolute;\n  will-change: transform;\n  box-shadow: var(--overlay-box-shadow);\n  transition: none;\n\n  --overlay-bg: transparent;\n  --overlay-box-shadow: inset 0 0 0 1px transparent;\n\n  [data-overlays] & {\n    --overlay-bg: color-mix(in srgb, transparent 95%, var(--card-focus-ring-color));\n    --overlay-box-shadow: inset 0 0 0 2px\n      color-mix(in srgb, transparent 50%, var(--card-focus-ring-color));\n  }\n\n  [data-fading-out] & {\n    transition:\n      box-shadow 1550ms,\n      background-color 1550ms;\n\n    --overlay-bg: rgba(0, 0, 255, 0);\n    --overlay-box-shadow: inset 0 0 0 1px transparent;\n  }\n\n  &[data-focused] {\n    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);\n  }\n\n  &[data-hovered]:not([data-focused]) {\n    transition: none;\n    --overlay-box-shadow: inset 0 0 0 2px var(--card-focus-ring-color);\n  }\n\n  /* [data-unmounted] & {\n    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);\n  } */\n\n  :link {\n    text-decoration: none;\n  }\n`\n\nconst Actions = styled(Flex)`\n  bottom: 100%;\n  cursor: pointer;\n  pointer-events: none;\n  position: absolute;\n  right: 0;\n\n  [data-hovered] & {\n    pointer-events: all;\n  }\n\n  [data-flipped] & {\n    bottom: auto;\n    top: 100%;\n  }\n`\n\nconst Tab = styled(Flex)`\n  bottom: 100%;\n  cursor: pointer;\n  pointer-events: none;\n  position: absolute;\n  left: 0;\n\n  [data-hovered] & {\n    pointer-events: all;\n  }\n\n  [data-flipped] & {\n    bottom: auto;\n    top: 100%;\n  }\n`\n\nconst ActionOpen = styled(Card)`\n  cursor: pointer;\n  background-color: var(--card-focus-ring-color);\n  right: 0;\n  border-radius: 3px;\n\n  & [data-ui='Text'] {\n    color: #fff;\n    white-space: nowrap;\n  }\n`\n\nconst Labels = styled(Flex)`\n  display: flex;\n  align-items: center;\n  background-color: var(--card-focus-ring-color);\n  right: 0;\n  border-radius: 3px;\n  & [data-ui='Text'],\n  & [data-sanity-icon] {\n    color: #fff;\n    white-space: nowrap;\n  }\n`\n\nfunction createIntentLink(node: SanityNode) {\n  const {id, type, path, baseUrl, tool, workspace} = node\n\n  return createEditUrl({\n    baseUrl,\n    workspace,\n    tool,\n    type: type!,\n    id,\n    path: pathToUrlString(studioPath.fromString(path)),\n  })\n}\n\nconst ElementOverlayInner: FunctionComponent<ElementOverlayProps> = (props) => {\n  const {element, focused, componentResolver, node, showActions, draggable} = props\n\n  const {getField, getType} = useSchema()\n  const schemaType = getType(node)\n  const {field, parent} = getField(node)\n\n  const href = 'path' in node ? createIntentLink(node) : node.href\n\n  const previewSnapshots = usePreviewSnapshots()\n\n  const title = useMemo(() => {\n    if (!('path' in node)) return undefined\n    return previewSnapshots.find((snapshot) => snapshot._id === node.id)?.title\n  }, [node, previewSnapshots])\n\n  const componentContext = useMemo<OverlayComponentResolverContext | undefined>(() => {\n    if (!('path' in node)) return undefined\n    if (!field || !schemaType) return undefined\n    const type = field.value.type\n\n    return {\n      document: schemaType,\n      element,\n      field,\n      focused: !!focused,\n      node,\n      parent,\n      type,\n    }\n  }, [schemaType, element, field, focused, node, parent])\n\n  const customComponents = useCustomComponents(componentContext, componentResolver)\n\n  const icon = schemaType?.icon ? (\n    <div dangerouslySetInnerHTML={{__html: schemaType.icon}} />\n  ) : (\n    <DocumentIcon />\n  )\n\n  return (\n    <>\n      {showActions ? (\n        <Actions gap={1} paddingY={1} data-sanity-overlay-element>\n          <Link href={href} />\n        </Actions>\n      ) : null}\n      {title && (\n        <Tab gap={1} paddingY={1}>\n          <Labels gap={2} padding={2}>\n            {draggable && (\n              <Box marginRight={1}>\n                <Text className=\"drag-handle\" size={0}>\n                  <DragHandleIcon />\n                </Text>\n              </Box>\n            )}\n            <Text size={0}>{icon}</Text>\n            <Text size={1} weight=\"medium\">\n              {title}\n            </Text>\n          </Labels>\n        </Tab>\n      )}\n\n      {Array.isArray(customComponents)\n        ? customComponents.map(({component: Component, props}, i) => {\n            return (\n              <Component key={i} PointerEvents={PointerEvents} {...componentContext!} {...props} />\n            )\n          })\n        : customComponents}\n    </>\n  )\n}\n\nexport const ElementOverlay = memo(function ElementOverlay(props: ElementOverlayProps) {\n  const {draggable, focused, hovered, rect, wasMaybeCollapsed, enableScrollIntoView} = props\n\n  const ref = useRef<HTMLDivElement>(null)\n\n  const scrolledIntoViewRef = useRef(false)\n\n  const style = useMemo<CSSProperties>(\n    () => ({\n      width: `${rect.w}px`,\n      height: `${rect.h}px`,\n      transform: `translate(${rect.x}px, ${rect.y}px)`,\n    }),\n    [rect],\n  )\n\n  useEffect(() => {\n    if (\n      !scrolledIntoViewRef.current &&\n      !wasMaybeCollapsed &&\n      focused === true &&\n      ref.current &&\n      enableScrollIntoView\n    ) {\n      const target = ref.current\n      scrollIntoView(ref.current, {\n        // Workaround issue with scroll-into-view-if-needed struggling with iframes\n        behavior: (actions) => {\n          if (actions.length === 0) {\n            // An empty actions list equals scrolling isn't needed\n            return\n          }\n          // Uses native scrollIntoView to ensure iframes behave correctly\n          target.scrollIntoView({\n            behavior: 'smooth',\n            block: 'center',\n            inline: 'nearest',\n          })\n        },\n        scrollMode: 'if-needed',\n        block: 'center',\n        inline: 'nearest',\n      })\n    }\n\n    scrolledIntoViewRef.current = focused === true\n  }, [focused, wasMaybeCollapsed, enableScrollIntoView])\n\n  const [isNearTop, setIsNearTop] = useState(false)\n  useEffect(() => {\n    if (!ref.current || !hovered) return undefined\n\n    const io = new IntersectionObserver(\n      ([intersection]) => {\n        setIsNearTop(intersection.boundingClientRect.top < 0)\n      },\n      {threshold: 1},\n    )\n    io.observe(ref.current)\n    return () => io.disconnect()\n  }, [hovered, isNearTop])\n\n  return (\n    <Root\n      data-focused={focused ? '' : undefined}\n      data-hovered={hovered ? '' : undefined}\n      data-flipped={isNearTop ? '' : undefined}\n      data-draggable={draggable ? '' : undefined}\n      ref={ref}\n      style={style}\n    >\n      {hovered && <ElementOverlayInner {...props} />}\n    </Root>\n  )\n})\n\nfunction useCustomComponents(\n  componentContext: OverlayComponentResolverContext | undefined,\n  componentResolver: OverlayComponentResolver | undefined,\n) {\n  return useMemo(() => {\n    if (!componentContext) return undefined\n    const resolved = componentResolver?.(componentContext)\n    if (!resolved) return undefined\n\n    if (isReactElementOverlayComponent(resolved)) {\n      return resolved\n    }\n\n    return (Array.isArray(resolved) ? resolved : [resolved]).map((component) => {\n      if (typeof component === 'object' && 'component' in component) {\n        return component\n      }\n      return {component, props: {}}\n    })\n  }, [componentResolver, componentContext])\n}\n\nconst Link = memo(function Link(props: {href: string}) {\n  const referer = useSyncExternalStore(\n    useCallback((onStoreChange) => {\n      const handlePopState = () => onStoreChange()\n      window.addEventListener('popstate', handlePopState)\n      return () => window.removeEventListener('popstate', handlePopState)\n    }, []),\n    () => window.location.href,\n  )\n  const href = useMemo(() => getLinkHref(props.href, referer), [props.href, referer])\n\n  return (\n    <Box as=\"a\" href={href} target=\"_blank\" rel=\"noopener noreferrer\">\n      <ActionOpen padding={2}>\n        <Text size={1} weight=\"medium\">\n          Open in Studio\n        </Text>\n      </ActionOpen>\n    </Box>\n  )\n})\n","import type {FunctionComponent} from 'react'\nimport type {OverlayRect} from '../types'\n\nexport const OverlayDragGroupRect: FunctionComponent<{\n  dragGroupRect: OverlayRect\n}> = ({dragGroupRect}) => {\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        top: `${dragGroupRect.y}px`,\n        left: `${dragGroupRect.x}px`,\n        width: `${dragGroupRect.w - 1}px`,\n        height: `${dragGroupRect.h - 1}px`,\n        border: '1px dashed #f0709b',\n        pointerEvents: 'none',\n      }}\n    ></div>\n  )\n}\n","import type {FunctionComponent} from 'react'\nimport type {DragInsertPosition} from '../types'\n\nconst markerThickness = 6\n\nfunction lerp(v0: number, v1: number, t: number) {\n  return v0 * (1 - t) + v1 * t\n}\n\nexport const OverlayDragInsertMarker: FunctionComponent<{\n  dragInsertPosition: DragInsertPosition\n}> = ({dragInsertPosition}) => {\n  if (dragInsertPosition === null) return\n\n  const flow = dragInsertPosition?.left || dragInsertPosition?.right ? 'horizontal' : 'vertical'\n\n  let x = 0\n  let y = 0\n  let width = 0\n  let height = 0\n  const offsetMultiplier = 0.0125\n\n  if (flow === 'horizontal') {\n    const {left, right} = dragInsertPosition\n\n    width = markerThickness\n\n    if (right && left) {\n      const startX = left.rect.x + left.rect.w\n      const endX = right.rect.x\n      const targetHeight = Math.min(right.rect.h, left.rect.h)\n      const offset = targetHeight * offsetMultiplier\n\n      x = lerp(startX, endX, 0.5) - markerThickness / 2\n      y = left.rect.y + offset\n\n      height = Math.min(right.rect.h, left.rect.h) - offset * 2\n    } else if (right && !left) {\n      const targetHeight = right.rect.h\n      const offset = targetHeight * offsetMultiplier\n\n      x = right.rect.x - markerThickness / 2\n      y = right.rect.y + offset\n      height = right.rect.h - offset * 2\n    } else if (left && !right) {\n      const targetHeight = left.rect.h\n      const offset = targetHeight * offsetMultiplier\n\n      x = left.rect.x + left.rect.w - markerThickness / 2\n      y = left.rect.y + offset\n      height = left.rect.h - offset * 2\n    }\n  } else {\n    const {bottom, top} = dragInsertPosition\n\n    if (bottom && top) {\n      const startX = Math.min(top.rect.x, bottom.rect.x)\n      const startY = top.rect.y + top.rect.h\n      const endY = bottom.rect.y\n      const targetWidth = Math.min(bottom.rect.w, top.rect.w)\n      const offset = targetWidth * offsetMultiplier\n\n      height = markerThickness\n\n      x = startX + offset\n      y = lerp(startY, endY, 0.5) - markerThickness / 2\n      width = Math.max(bottom.rect.w, top.rect.w) - offset * 2\n    } else if (bottom && !top) {\n      const targetWidth = bottom.rect.w\n      const offset = targetWidth * offsetMultiplier\n\n      x = bottom.rect.x + offset\n      y = bottom.rect.y - markerThickness / 2\n      width = bottom.rect.w - offset * 2\n      height = markerThickness\n    } else if (top && !bottom) {\n      const targetWidth = top.rect.w\n      const offset = targetWidth * offsetMultiplier\n\n      x = top.rect.x + offset\n      y = top.rect.y + top.rect.h - markerThickness / 2\n      width = top.rect.w - offset * 2\n      height = markerThickness\n    }\n  }\n\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        width: `${width}px`,\n        height: `${height}px`,\n        transform: `translate(${x}px, ${y}px)`,\n        background: '#556bfc',\n        border: '2px solid white',\n        borderRadius: '999px',\n        zIndex: '999999',\n      }}\n    ></div>\n  )\n}\n","import {Card, usePrefersDark, useTheme_v2} from '@sanity/ui/_visual-editing'\nimport type {FunctionComponent} from 'react'\nimport {styled} from 'styled-components'\nimport type {DragSkeleton} from '../types'\n\nconst Root = styled.div<{\n  $width: number\n  $height: number\n  $offsetX: number\n  $offsetY: number\n  $scaleFactor: number\n}>`\n  --drag-preview-opacity: 0.98;\n  --drag-preview-skeleton-stroke: #ffffff;\n\n  @media (prefers-color-scheme: dark) {\n    --drag-preview-skeleton-stroke: #383d51;\n  }\n\n  position: fixed;\n  display: grid;\n  transform: ${({$scaleFactor, $width, $height}) =>\n    `translate(calc(var(--drag-preview-x) - ${$width / 2}px), calc(var(--drag-preview-y) - ${$height / 2}px)) scale(${$scaleFactor})`};\n  width: ${({$width}) => `${$width}px`};\n  height: ${({$height}) => `${$height}px`};\n  z-index: 9999999;\n  opacity: var(--drag-preview-opacity);\n  cursor: move;\n\n  .drag-preview-content-wrapper {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    container-type: inline-size;\n  }\n\n  [data-ui='card'] {\n    position: relative;\n    width: 100%;\n    height: 100%;\n  }\n\n  .drag-preview-skeleton {\n    position: absolute;\n    inset: 0;\n\n    rect {\n      stroke: var(--drag-preview-skeleton-stroke);\n    }\n  }\n\n  .drag-preview-handle {\n    position: absolute;\n    top: 4cqmin;\n    left: 4cqmin;\n    width: 6cqmin;\n    fill: var(--drag-preview-handle-fill);\n  }\n`\n\nfunction clamp(number: number, min: number, max: number): number {\n  return number < min ? min : number > max ? max : number\n}\n\nfunction map(number: number, inMin: number, inMax: number, outMin: number, outMax: number): number {\n  const mapped: number = ((number - inMin) * (outMax - outMin)) / (inMax - inMin) + outMin\n  return clamp(mapped, outMin, outMax)\n}\n\nexport const OverlayDragPreview: FunctionComponent<{skeleton: DragSkeleton}> = ({skeleton}) => {\n  const maxSkeletonWidth = Math.min(skeleton.maxWidth, window.innerWidth / 2)\n  const scaleFactor = skeleton.w > maxSkeletonWidth ? maxSkeletonWidth / skeleton.w : 1\n\n  const offsetX = skeleton.offsetX * scaleFactor\n  const offsetY = skeleton.offsetY * scaleFactor\n\n  const prefersDark = usePrefersDark()\n  const theme = useTheme_v2()\n\n  const radius = theme.radius[~~map(skeleton.w, 0, 1920, 1, theme.radius.length - 2)]\n\n  const imageRects = skeleton.childRects.filter((r) => r.tagName === 'IMG')\n  const textRects = skeleton.childRects.filter((r) => r.tagName !== 'IMG')\n\n  return (\n    <Root\n      $width={skeleton.w}\n      $height={skeleton.h}\n      $offsetX={offsetX}\n      $offsetY={offsetY}\n      $scaleFactor={scaleFactor}\n    >\n      <Card\n        radius={radius}\n        shadow={4}\n        overflow=\"hidden\"\n        tone=\"transparent\"\n        scheme={prefersDark ? 'dark' : 'light'}\n      >\n        <div className=\"drag-preview-content-wrapper\">\n          <svg className=\"drag-preview-skeleton\" viewBox={`0 0 ${skeleton.w} ${skeleton.h}`}>\n            {/* render image rects first to account for background images overlapping text */}\n            {[...imageRects, ...textRects].map((r, i) => (\n              <rect\n                key={i}\n                x={r.x}\n                y={r.y}\n                width={r.w}\n                height={r.h}\n                fill={theme.color.skeleton.from}\n              ></rect>\n            ))}\n          </svg>\n        </div>\n      </Card>\n    </Root>\n  )\n}\n","import {ExpandIcon} from '@sanity/icons'\nimport {Card, Flex, Hotkeys, Text} from '@sanity/ui/_visual-editing'\nimport type {FunctionComponent} from 'react'\nimport {styled} from 'styled-components'\n\nconst Root = styled(Card)`\n  position: fixed;\n  bottom: 2rem;\n  left: 2rem;\n`\n\nexport const OverlayMinimapPrompt: FunctionComponent = () => {\n  return (\n    <Root padding={2} shadow={2} radius={2} style={{zIndex: '999999'}}>\n      <Flex align=\"center\" gap={2}>\n        <Hotkeys keys={['Shift']} />\n        <Text size={1}>Zoom Out</Text>\n        <ExpandIcon />\n      </Flex>\n    </Root>\n  )\n}\n","import type {VisualEditingControllerMsg} from '@sanity/presentation-comlink'\nimport type {ElementState, OverlayMsg} from '../types'\n\n/**\n * Reducer for managing element state from received channel messages\n * @internal\n */\nexport const elementsReducer = (\n  elements: ElementState[],\n  message: OverlayMsg | VisualEditingControllerMsg,\n): ElementState[] => {\n  const {type} = message\n  switch (type) {\n    case 'element/register': {\n      const elementExists = !!elements.find((e) => e.id === message.id)\n      if (elementExists) return elements\n\n      return [\n        ...elements,\n        {\n          id: message.id,\n          activated: false,\n          element: message.element,\n          focused: false,\n          hovered: false,\n          rect: message.rect,\n          sanity: message.sanity,\n          dragDisabled: message.dragDisabled,\n        },\n      ]\n    }\n    case 'element/activate':\n      return elements.map((e) => {\n        if (e.id === message.id) {\n          return {...e, activated: true}\n        }\n        return e\n      })\n    case 'element/update': {\n      return elements.map((e) => {\n        if (e.id === message.id) {\n          return {...e, sanity: message.sanity, rect: message.rect}\n        }\n        return e\n      })\n    }\n    case 'element/unregister':\n      return elements.filter((e) => e.id !== message.id)\n    case 'element/deactivate':\n      return elements.map((e) => {\n        if (e.id === message.id) {\n          return {...e, activated: false, hovered: false}\n        }\n        return e\n      })\n    case 'element/mouseenter':\n      return elements.map((e) => {\n        if (e.id === message.id) {\n          return {...e, rect: message.rect, hovered: true}\n        }\n        return {...e, hovered: false}\n      })\n    case 'element/mouseleave':\n      return elements.map((element) => {\n        if (element.id === message.id) {\n          return {...element, hovered: false}\n        }\n        return element\n      })\n    case 'element/updateRect':\n      return elements.map((element) => {\n        if (element.id === message.id) {\n          return {...element, rect: message.rect}\n        }\n        return element\n      })\n    case 'element/click':\n      return elements.map((e) => {\n        return {...e, focused: e.id === message.id && 'clicked'}\n      })\n    case 'overlay/blur':\n      return elements.map((e) => {\n        return {...e, focused: false}\n      })\n    case 'presentation/blur':\n      return elements.map((e) => {\n        return {...e, focused: false}\n      })\n    case 'presentation/focus': {\n      // Before setting the focus state of each element, check to see if any\n      // element has gained focus from an `element/click` message. Presentation\n      // tool \"reflects\" these back as a `presentation/focus` message.\n      const clickedElement = elements.find((e) => e.focused === 'clicked')\n      return elements.map((e) => {\n        // We want to focus any element which matches the received id and path\n        const focused =\n          'path' in e.sanity &&\n          e.sanity.id === message.data.id &&\n          e.sanity.path === message.data.path\n\n        // If we have a 'clicked' element, and that element matches, it is a\n        // reflection, so we maintain the focus state\n        if (clickedElement && e === clickedElement && focused) {\n          return e\n        }\n\n        return {\n          ...e,\n          // Mark as a dupe if another matching item has been clicked to prevent\n          // scrolling, otherwise just set focus as a boolean\n          focused: focused && clickedElement ? 'duplicate' : focused,\n        }\n      })\n    }\n    default:\n      return elements\n  }\n}\n","import type {ClientPerspective} from '@sanity/client'\nimport type {SanityNode, VisualEditingControllerMsg} from '@sanity/presentation-comlink'\nimport type {\n  DragInsertPosition,\n  DragSkeleton,\n  ElementState,\n  OverlayMsg,\n  OverlayRect,\n} from '../types'\nimport {elementsReducer} from './elementsReducer'\n\nexport interface OverlayState {\n  contextMenu: {\n    node: SanityNode\n    position: {\n      x: number\n      y: number\n    }\n  } | null\n  focusPath: string\n  elements: ElementState[]\n  wasMaybeCollapsed: boolean\n  perspective: ClientPerspective\n  isDragging: boolean\n  dragInsertPosition: DragInsertPosition\n  dragSkeleton: DragSkeleton | null\n  dragShowMinimap: boolean\n  dragShowMinimapPrompt: boolean\n  dragMinimapTransition: boolean\n  dragGroupRect: OverlayRect | null\n}\n\nexport function overlayStateReducer(\n  state: OverlayState,\n  message: OverlayMsg | VisualEditingControllerMsg,\n): OverlayState {\n  const {type} = message\n  let {\n    contextMenu,\n    focusPath,\n    perspective,\n    isDragging,\n    dragInsertPosition,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragSkeleton,\n    dragMinimapTransition,\n    dragGroupRect,\n  } = state\n  let wasMaybeCollapsed = false\n\n  if (type === 'presentation/focus') {\n    const prevFocusPath = state.focusPath\n\n    focusPath = message.data.path\n\n    if (prevFocusPath !== focusPath) {\n      wasMaybeCollapsed = prevFocusPath.slice(focusPath.length).startsWith('[')\n    }\n  }\n\n  if (type === 'presentation/perspective') {\n    perspective = message.data.perspective\n  }\n\n  if (type === 'element/contextmenu') {\n    if ('sanity' in message) {\n      contextMenu = {node: message.sanity, position: message.position}\n    } else {\n      contextMenu = null\n    }\n  }\n\n  if (\n    type === 'element/click' ||\n    type === 'element/mouseleave' ||\n    type === 'overlay/blur' ||\n    type === 'presentation/blur' ||\n    type === 'presentation/focus'\n  ) {\n    contextMenu = null\n  }\n\n  if (type === 'overlay/dragUpdateInsertPosition') {\n    dragInsertPosition = message.insertPosition\n  }\n\n  if (type === 'overlay/dragStart') {\n    isDragging = true\n  }\n\n  if (message.type === 'overlay/dragUpdateSkeleton') {\n    dragSkeleton = message.skeleton\n  }\n\n  if (type === 'overlay/dragEnd') {\n    isDragging = false\n  }\n\n  if (message.type === 'overlay/dragToggleMinimapPrompt') {\n    dragShowMinimapPrompt = message.display\n  }\n\n  if (type === 'overlay/dragStartMinimapTransition') {\n    dragMinimapTransition = true\n  }\n\n  if (type === 'overlay/dragEndMinimapTransition') {\n    dragMinimapTransition = false\n  }\n\n  if (type === 'overlay/dragUpdateGroupRect') {\n    dragGroupRect = message.groupRect\n  }\n\n  if (type === 'overlay/dragToggleMinimap') {\n    dragShowMinimap = message.display\n  }\n\n  return {\n    ...state,\n    contextMenu,\n    elements: elementsReducer(state.elements, message),\n    dragInsertPosition,\n    dragSkeleton,\n    dragGroupRect,\n    isDragging,\n    focusPath,\n    perspective,\n    wasMaybeCollapsed,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragMinimapTransition,\n  }\n}\n","import {\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n  type FunctionComponent,\n  type PropsWithChildren,\n} from 'react'\nimport type {VisualEditingNode} from '../../types'\nimport {PreviewSnapshotsContext, type PreviewSnapshotsContextValue} from './PreviewSnapshotsContext'\n\nexport const PreviewSnapshotsProvider: FunctionComponent<\n  PropsWithChildren<{\n    comlink?: VisualEditingNode\n  }>\n> = function (props) {\n  const {comlink, children} = props\n\n  const [previewSnapshots, setPreviewSnapshots] = useState<PreviewSnapshotsContextValue>([])\n\n  const fetchPreviewSnapshots = useCallback(\n    async (signal: AbortSignal) => {\n      if (!comlink) return\n      try {\n        const response = await comlink.fetch('visual-editing/preview-snapshots', undefined, {\n          signal,\n          suppressWarnings: true,\n        })\n        setPreviewSnapshots(response.snapshots)\n      } catch (e) {\n        // Fail silently as the app may be communicating with a version of\n        // Presentation that does not support this feature\n      }\n    },\n    [comlink],\n  )\n  useEffect(() => {\n    if (!comlink) return\n\n    const previewSapshotsFetch = new AbortController()\n    const unsub = comlink.onStatus(() => {\n      fetchPreviewSnapshots(previewSapshotsFetch.signal)\n    }, 'connected')\n\n    return () => {\n      previewSapshotsFetch.abort()\n      unsub()\n    }\n  }, [comlink, fetchPreviewSnapshots])\n\n  useEffect(() => {\n    return comlink?.on('presentation/preview-snapshots', (data) => {\n      setPreviewSnapshots(data.snapshots)\n    })\n  }, [comlink])\n\n  const context = useMemo<PreviewSnapshotsContextValue>(() => previewSnapshots, [previewSnapshots])\n  return (\n    <PreviewSnapshotsContext.Provider value={context}>{children}</PreviewSnapshotsContext.Provider>\n  )\n}\n","import type {\n  DocumentSchema,\n  ResolvedSchemaTypeMap,\n  SanityNode,\n  SanityStegaNode,\n  SchemaType,\n  TypeSchema,\n  UnresolvedPath,\n} from '@sanity/presentation-comlink'\nimport {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  type FunctionComponent,\n  type PropsWithChildren,\n} from 'react'\nimport type {\n  ElementState,\n  OverlayElementField,\n  OverlayElementParent,\n  VisualEditingNode,\n} from '../../types'\nimport {SchemaContext, type SchemaContextValue} from './SchemaContext'\n\nfunction isSanityNode(node: SanityNode | SanityStegaNode): node is SanityNode {\n  return 'path' in node\n}\n\nfunction isDocumentSchemaType(type: SchemaType): type is DocumentSchema {\n  return type.type === 'document'\n}\n\nfunction isTypeSchemaType(type: SchemaType): type is TypeSchema {\n  return type.type === 'type'\n}\n\nfunction popUnkeyedPathSegments(path: string): string {\n  return path\n    .split('.')\n    .toReversed()\n    .reduce((acc, part) => {\n      if (acc.length) return [part, ...acc]\n      if (part.includes('[_key==')) return [part]\n      return []\n    }, [] as string[])\n    .join('.')\n}\n\nfunction getPathsWithUnresolvedTypes(elements: ElementState[]): {id: string; path: string}[] {\n  return elements.reduce((acc, element) => {\n    const {sanity} = element\n    if (!('id' in sanity)) return acc\n    if (!sanity.path.includes('[_key==')) return acc\n    const path = popUnkeyedPathSegments(sanity.path)\n    if (!acc.find((item) => item.id === sanity.id && item.path === path)) {\n      acc.push({id: sanity.id, path})\n    }\n    return acc\n  }, [] as UnresolvedPath[])\n}\n\nexport const SchemaProvider: FunctionComponent<\n  PropsWithChildren<{\n    comlink?: VisualEditingNode\n    elements: ElementState[]\n  }>\n> = function (props) {\n  const {comlink, children, elements} = props\n\n  const [resolvedTypes, setResolvedTypes] = useState<ResolvedSchemaTypeMap>(new Map())\n\n  const [schema, setSchema] = useState<SchemaType[] | null>(null)\n\n  const fetchSchema = useCallback(\n    async (signal: AbortSignal) => {\n      if (!comlink) return\n      try {\n        const response = await comlink.fetch('visual-editing/schema', undefined, {\n          signal,\n          suppressWarnings: true,\n        })\n        setSchema(response.schema)\n      } catch (e) {\n        // Fail silently as the app may be communicating with a version of\n        // Presentation that does not support this feature\n      }\n    },\n    [comlink],\n  )\n  useEffect(() => {\n    if (!comlink) return\n\n    const schemaFetch = new AbortController()\n    const unsub = comlink.onStatus(() => {\n      fetchSchema(schemaFetch.signal)\n    }, 'connected')\n\n    return () => {\n      schemaFetch.abort()\n      unsub()\n    }\n  }, [comlink, fetchSchema])\n\n  const reportedPathsRef = useRef<UnresolvedPath[]>([])\n\n  useEffect(() => {\n    // We report a list of paths that reference array items using a _key. We need\n    // to resolve the types of each of these items so we can map them to the\n    // correct schema types. One day CSM might include this data for us.\n    const reportPaths = async (paths: UnresolvedPath[], signal: AbortSignal) => {\n      if (!paths.length || !comlink) return\n      try {\n        const response = await comlink.fetch(\n          'visual-editing/schema-union-types',\n          {paths},\n          {signal, suppressWarnings: true},\n        )\n        setResolvedTypes(response.types)\n        reportedPathsRef.current = paths\n      } catch (e) {\n        // Fail silently as the app may be communicating with a version of\n        // Presentation that does not support this feature\n      }\n    }\n\n    const controller = new AbortController()\n    const paths = getPathsWithUnresolvedTypes(elements)\n    if (\n      paths.some(\n        (p) => !reportedPathsRef.current.find(({id, path}) => id === p.id && path === p.path),\n      )\n    ) {\n      reportPaths(paths, controller.signal)\n    }\n    return () => controller.abort()\n  }, [comlink, elements])\n\n  const getType = useCallback(\n    <T extends 'document' | 'type' = 'document'>(\n      node: SanityNode | SanityStegaNode | string,\n      _type?: T,\n    ): T extends 'document' ? DocumentSchema | undefined : TypeSchema | undefined => {\n      const type = _type || 'document'\n      if (\n        !schema ||\n        (typeof node !== 'string' && (!isSanityNode(node) || !Array.isArray(schema)))\n      ) {\n        return undefined\n      }\n      const name = typeof node === 'string' ? node : node.type\n      const filter = type === 'document' ? isDocumentSchemaType : isTypeSchemaType\n      return schema\n        .filter(filter)\n        .find((schemaType) => schemaType.name === name) as T extends 'document'\n        ? DocumentSchema | undefined\n        : TypeSchema | undefined\n    },\n    [schema],\n  )\n\n  const getField = useCallback(\n    (\n      node: SanityNode | SanityStegaNode,\n    ): {\n      field: OverlayElementField\n      parent: OverlayElementParent\n    } => {\n      if (!isSanityNode(node)) {\n        return {\n          field: undefined,\n          parent: undefined,\n        }\n      }\n\n      const schemaType = getType(node)\n\n      if (!schemaType) {\n        return {\n          field: undefined,\n          parent: undefined,\n        }\n      }\n      function fieldFromPath(\n        schemaType: OverlayElementParent,\n        path: string[],\n        parent: OverlayElementParent,\n        prevPath: string[] = [],\n      ): {\n        field: OverlayElementField\n        parent: OverlayElementParent\n      } {\n        if (!schemaType) {\n          return {field: undefined, parent: undefined}\n        }\n\n        const [next, ...rest] = path\n\n        if ('fields' in schemaType) {\n          const objectField = schemaType.fields[next]\n          if (!objectField && 'rest' in schemaType) {\n            return fieldFromPath(schemaType.rest, path, schemaType, prevPath)\n          }\n          if (!rest.length) {\n            return {field: objectField, parent}\n          }\n          if (!objectField) {\n            throw new Error(\n              `[@sanity/visual-editing] No field could be resolved at path: \"${[...prevPath, ...path].join('.')}\"`,\n            )\n          }\n          return fieldFromPath(objectField.value, rest, schemaType, [...prevPath, next])\n        } else if (schemaType.type === 'array') {\n          return fieldFromPath(schemaType.of, path, schemaType, prevPath)\n        } else if (schemaType.type === 'arrayItem') {\n          if (!rest.length) return {field: schemaType, parent}\n          return fieldFromPath(schemaType.value, rest, schemaType, [...prevPath, next])\n        } else if (schemaType.type === 'union') {\n          const name = next.startsWith('[_key==')\n            ? resolvedTypes\n                ?.get((node as SanityNode).id)\n                ?.get([prevPath.join('.'), next].filter(Boolean).join(''))\n            : next\n          return fieldFromPath(\n            schemaType.of.find((item) => (item.type === 'unionOption' ? item.name === name : item)),\n            rest,\n            schemaType,\n            [...prevPath, next],\n          )\n        } else if (schemaType.type === 'unionOption') {\n          if (!next) return {field: schemaType, parent}\n          return fieldFromPath(schemaType.value, path, schemaType, prevPath)\n        } else if (schemaType.type === 'inline') {\n          const type = getType(schemaType.name, 'type')\n          return fieldFromPath((type as TypeSchema).value, path, schemaType, prevPath)\n        }\n        throw new Error(\n          `[@sanity/visual-editing] No field could be resolved at path: \"${[...prevPath, ...path].join('.')}\"`,\n        )\n      }\n\n      const nodePath = node.path.split('.').flatMap((part) => {\n        if (part.includes('[')) {\n          return part.split(/(\\[.+\\])/, 2)\n        }\n        return [part]\n      })\n\n      try {\n        return fieldFromPath(schemaType, nodePath, undefined)\n      } catch (e) {\n        // eslint-disable-next-line no-console\n        if (e instanceof Error) console.warn(e.message)\n        return {field: undefined, parent: undefined}\n      }\n    },\n    [getType, resolvedTypes],\n  )\n\n  const context = useMemo<SchemaContextValue>(\n    () => ({\n      getField,\n      getType,\n      resolvedTypes,\n      schema: schema || [],\n    }),\n    [getField, getType, resolvedTypes, schema],\n  )\n  return <SchemaContext.Provider value={context}>{children}</SchemaContext.Provider>\n}\n","import type {SerializableObject} from '@sanity/presentation-comlink'\nimport {useEffect, useMemo, type FunctionComponent, type PropsWithChildren} from 'react'\nimport type {VisualEditingNode} from '../../types'\nimport {SharedStateContext} from './SharedStateContext'\n\nconst createStore = (initialState: SerializableObject) => {\n  let state = initialState\n  const getState = () => state\n  const listeners = new Set<() => void>()\n  const setState = (fn: (state: SerializableObject) => SerializableObject) => {\n    state = fn(state)\n    listeners.forEach((l) => l())\n  }\n  const subscribe = (listener: () => void) => {\n    listeners.add(listener)\n    return () => listeners.delete(listener)\n  }\n  return {getState, setState, subscribe}\n}\n\nconst store = createStore({})\n\nexport const SharedStateProvider: FunctionComponent<\n  PropsWithChildren<{\n    comlink?: VisualEditingNode\n  }>\n> = (props) => {\n  const {comlink, children} = props\n\n  useEffect(() => {\n    return comlink?.on('presentation/shared-state', (data) => {\n      if ('value' in data) {\n        store.setState((prev) => ({...prev, [data.key]: data.value}))\n      } else {\n        store.setState((prev) => {\n          return Object.fromEntries(Object.entries(prev).filter(([key]) => key !== data.key))\n        })\n      }\n    })\n  }, [comlink])\n\n  useEffect(() => {\n    async function fetch() {\n      const value = await comlink?.fetch('visual-editing/shared-state', undefined, {\n        suppressWarnings: true,\n      })\n      if (value) {\n        store.setState(() => value.state)\n      }\n    }\n    fetch().catch((reason) => {\n      // eslint-disable-next-line no-console\n      console.debug(reason)\n      // eslint-disable-next-line no-console\n      console.warn(\n        '[@sanity/visual-editing]: Failed to fetch shared state. Check your version of `sanity` is up-to-date',\n      )\n    })\n  }, [comlink])\n\n  const value = useMemo(() => ({comlink, store}), [comlink])\n\n  return <SharedStateContext.Provider value={value}>{children}</SharedStateContext.Provider>\n}\n","import {useCallback, type FunctionComponent, type PropsWithChildren} from 'react'\nimport type {VisualEditingNode} from '../../types'\nimport {events, TelemetryContext, type TelemetryContextValue} from './TelemetryContext'\n\nexport const TelemetryProvider: FunctionComponent<\n  PropsWithChildren<{comlink?: VisualEditingNode}>\n> = ({children, comlink}) => {\n  const log = useCallback<TelemetryContextValue>(\n    (name, data) => {\n      if (!comlink) return\n\n      const event = events[name]\n\n      if (!event) {\n        throw new Error(`Telemetry event: ${name} does not exist`)\n      } else {\n        comlink.post('visual-editing/telemetry-log', {event, data})\n      }\n    },\n    [comlink],\n  )\n\n  return <TelemetryContext.Provider value={log}>{children}</TelemetryContext.Provider>\n}\n","import {useEffect, useRef, type MutableRefObject} from 'react'\nimport {createOverlayController} from '../controller'\nimport {useOptimisticActorReady} from '../react/useOptimisticActor'\nimport type {OverlayController, OverlayEventHandler} from '../types'\n\n/**\n * Hook for using an overlay controller\n * @internal\n */\nexport function useController(\n  element: HTMLElement | null,\n  handler: OverlayEventHandler,\n  inFrame: boolean,\n  inPopUp: boolean,\n): MutableRefObject<OverlayController | undefined> {\n  const overlayController = useRef<OverlayController | undefined>(undefined)\n\n  const optimisticActorReady = useOptimisticActorReady()\n\n  useEffect(() => {\n    if (!element) return undefined\n\n    overlayController.current = createOverlayController({\n      handler,\n      overlayElement: element,\n      inFrame,\n      inPopUp,\n      optimisticActorReady,\n    })\n\n    return () => {\n      overlayController.current?.destroy()\n      overlayController.current = undefined\n    }\n  }, [element, handler, inFrame, inPopUp, optimisticActorReady])\n\n  return overlayController\n}\n","import type {VisualEditingControllerMsg} from '@sanity/presentation-comlink'\nimport {useEffect} from 'react'\nimport type {OverlayMsg, VisualEditingNode} from '../types'\n\nexport function usePerspectiveSync(\n  comlink: VisualEditingNode | undefined,\n  dispatch: (value: OverlayMsg | VisualEditingControllerMsg) => void,\n): void {\n  useEffect(() => {\n    const controller = new AbortController()\n    comlink\n      ?.fetch('visual-editing/fetch-perspective', undefined, {\n        signal: controller.signal,\n        suppressWarnings: true,\n      })\n      .then((data) => {\n        dispatch({type: 'presentation/perspective', data})\n      })\n      .catch(() => {\n        // Fail silently as the app may be communicating with a version of\n        // Presentation that does not support this feature\n      })\n\n    const unsub = comlink?.on('presentation/perspective', (data) => {\n      dispatch({type: 'presentation/perspective', data})\n    })\n\n    return () => {\n      unsub?.()\n      controller.abort()\n    }\n  }, [comlink, dispatch])\n}\n","import type {ClientPerspective, ContentSourceMapDocuments} from '@sanity/client'\nimport {useCallback, useEffect, useRef} from 'react'\nimport type {ElementState, SanityNode, VisualEditingNode} from '../types'\n\nfunction isEqualSets(a: Set<string>, b: Set<string>) {\n  if (a === b) return true\n  if (a.size !== b.size) return false\n  for (const value of a) if (!b.has(value)) return false\n  return true\n}\n\n/**\n * Hook for reporting in use documents to Presentation\n * @internal\n */\nexport function useReportDocuments(\n  comlink: VisualEditingNode | undefined,\n  elements: ElementState[],\n  perspective: ClientPerspective,\n): void {\n  const lastReported = useRef<\n    | {\n        nodeIds: Set<string>\n        perspective: ClientPerspective\n      }\n    | undefined\n  >(undefined)\n\n  const reportDocuments = useCallback(\n    (documents: ContentSourceMapDocuments, perspective: ClientPerspective) => {\n      comlink?.post('visual-editing/documents', {\n        documents,\n        perspective,\n      })\n    },\n    [comlink],\n  )\n\n  useEffect(() => {\n    // Report only nodes of type `SanityNode`. Untransformed `SanityStegaNode`\n    // nodes without an `id`, are not reported as they will not contain the\n    // necessary document data.\n    const nodes = elements\n      .map((e) => {\n        const {sanity} = e\n        if (!('id' in sanity)) return null\n        return sanity\n      })\n      .filter((s) => !!s) as SanityNode[]\n\n    const nodeIds = new Set<string>(nodes.map((e) => e.id))\n    // Report if:\n    // - Documents not yet reported\n    // - Document IDs changed\n    // - Perspective changed\n    if (\n      !lastReported.current ||\n      !isEqualSets(nodeIds, lastReported.current.nodeIds) ||\n      perspective !== lastReported.current.perspective\n    ) {\n      const documentsOnPage: ContentSourceMapDocuments = Array.from(nodeIds).map((_id) => {\n        const node = nodes.find((node) => node.id === _id)!\n        const {type, projectId: _projectId, dataset: _dataset} = node\n        return _projectId && _dataset\n          ? {_id, _type: type!, _projectId, _dataset}\n          : {_id, _type: type!}\n      })\n      lastReported.current = {nodeIds, perspective}\n      reportDocuments(documentsOnPage, perspective)\n    }\n  }, [elements, perspective, reportDocuments])\n}\n","import type {ClientPerspective} from '@sanity/client'\nimport {getDraftId, getPublishedId} from '@sanity/client/csm'\nimport type {Status} from '@sanity/comlink'\nimport {type VisualEditingControllerMsg} from '@sanity/presentation-comlink'\nimport {\n  isHTMLAnchorElement,\n  isHTMLElement,\n  LayerProvider,\n  PortalProvider,\n  studioTheme,\n  ThemeProvider,\n  usePrefersDark,\n} from '@sanity/ui/_visual-editing'\nimport {\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n  type FunctionComponent,\n} from 'react'\nimport {styled} from 'styled-components'\nimport {useOptimisticActor, useOptimisticActorReady} from '../react/useOptimisticActor'\nimport type {\n  OverlayComponentResolver,\n  OverlayEventHandler,\n  OverlayMsg,\n  VisualEditingNode,\n} from '../types'\nimport {sanityNodesExistInSameArray} from '../util/findSanityNodes'\nimport {useDragEndEvents} from '../util/useDragEvents'\nimport {ContextMenu} from './context-menu/ContextMenu'\nimport {ElementOverlay} from './ElementOverlay'\nimport {OverlayDragGroupRect} from './OverlayDragGroupRect'\nimport {OverlayDragInsertMarker} from './OverlayDragInsertMarker'\nimport {OverlayDragPreview} from './OverlayDragPreview'\nimport {OverlayMinimapPrompt} from './OverlayMinimapPrompt'\nimport {overlayStateReducer} from './overlayStateReducer'\nimport {PreviewSnapshotsProvider} from './preview/PreviewSnapshotsProvider'\nimport {SchemaProvider} from './schema/SchemaProvider'\nimport {SharedStateProvider} from './shared-state/SharedStateProvider'\nimport {TelemetryProvider} from './telemetry/TelemetryProvider'\nimport {useTelemetry} from './telemetry/useTelemetry'\nimport {useController} from './useController'\nimport {usePerspectiveSync} from './usePerspectiveSync'\nimport {useReportDocuments} from './useReportDocuments'\n\nconst Root = styled.div<{\n  $zIndex?: string | number\n}>`\n  background-color: transparent;\n  direction: ltr;\n  inset: 0;\n  pointer-events: none;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: ${({$zIndex}) => $zIndex ?? '9999999'};\n`\n\nfunction raf2(fn: () => void) {\n  let r0: number | undefined = undefined\n  let r1: number | undefined = undefined\n\n  r0 = requestAnimationFrame(() => {\n    r1 = requestAnimationFrame(fn)\n  })\n\n  return () => {\n    if (r0 !== undefined) cancelAnimationFrame(r0)\n    if (r1 !== undefined) cancelAnimationFrame(r1)\n  }\n}\n\nconst DocumentReporter: FunctionComponent<{\n  documentIds: string[]\n  perspective: ClientPerspective\n}> = (props) => {\n  const {documentIds} = props\n  const [uniqueIds, setUniqueIds] = useState<string[]>([])\n\n  useEffect(() => {\n    setUniqueIds((prev) => {\n      const next = Array.from(new Set(documentIds))\n      return prev.length === next.length &&\n        prev.reduce((acc, prevId) => acc.filter((id) => id !== prevId), next)?.length === 0\n        ? prev\n        : next\n    })\n  }, [documentIds])\n  const actor = useOptimisticActor()\n\n  useEffect(() => {\n    for (const id of uniqueIds) {\n      actor.send({type: 'observe', documentId: getDraftId(id)})\n      actor.send({type: 'observe', documentId: getPublishedId(id)})\n    }\n    return () => {\n      for (const id of uniqueIds) {\n        actor.send({type: 'unobserve', documentId: getDraftId(id)})\n        actor.send({type: 'unobserve', documentId: getPublishedId(id)})\n      }\n    }\n  }, [actor, uniqueIds])\n\n  return null\n}\n\nconst OverlaysController: FunctionComponent<{\n  comlink?: VisualEditingNode\n  dispatch: (value: OverlayMsg | VisualEditingControllerMsg) => void\n  inFrame: boolean\n  inPopUp: boolean\n  onDrag: (x: number, y: number) => void\n  overlayEnabled: boolean\n  rootElement: HTMLElement | null\n}> = (props) => {\n  const {comlink, dispatch, inFrame, inPopUp, onDrag, overlayEnabled, rootElement} = props\n  const {dispatchDragEndEvent} = useDragEndEvents()\n  const sendTelemetry = useTelemetry()\n\n  const overlayEventHandler: OverlayEventHandler = useCallback(\n    (message) => {\n      if (message.type === 'element/click') {\n        const {sanity} = message\n        comlink?.post('visual-editing/focus', sanity)\n\n        sendTelemetry('Visual Editing Overlay Clicked', null)\n      } else if (message.type === 'overlay/activate') {\n        comlink?.post('visual-editing/toggle', {enabled: true})\n      } else if (message.type === 'overlay/deactivate') {\n        comlink?.post('visual-editing/toggle', {enabled: false})\n      } else if (message.type === 'overlay/dragEnd') {\n        const {insertPosition, target, dragGroup, flow, preventInsertDefault} = message\n\n        dispatchDragEndEvent({insertPosition, target, dragGroup, flow, preventInsertDefault})\n\n        if (insertPosition) {\n          sendTelemetry('Visual Editing Drag Sequence Completed', null)\n        }\n      } else if (message.type === 'overlay/dragUpdateCursorPosition') {\n        onDrag(message.x, message.y)\n\n        return\n      } else if (message.type === 'overlay/dragToggleMinimap' && message.display === true) {\n        sendTelemetry('Visual Editing Drag Minimap Enabled', null)\n      } else if (message.type === 'overlay/setCursor') {\n        const {element, cursor} = message\n\n        if (cursor) {\n          element.style.cursor = cursor\n        } else {\n          element.style.removeProperty('cursor')\n        }\n      }\n\n      dispatch(message)\n    },\n    [comlink, dispatch, dispatchDragEndEvent, onDrag, sendTelemetry],\n  )\n\n  const controller = useController(rootElement, overlayEventHandler, inFrame, inPopUp)\n\n  useEffect(() => {\n    if (overlayEnabled) {\n      controller.current?.activate()\n    } else {\n      controller.current?.deactivate()\n    }\n  }, [controller, overlayEnabled])\n\n  return null\n}\n\n/**\n * @internal\n */\nexport const Overlays: FunctionComponent<{\n  comlink?: VisualEditingNode\n  comlinkStatus?: Status\n  componentResolver?: OverlayComponentResolver\n  inFrame: boolean\n  inPopUp: boolean\n  zIndex?: string | number\n}> = (props) => {\n  const {\n    comlink,\n    comlinkStatus,\n    componentResolver: _componentResolver,\n    inFrame,\n    inPopUp,\n    zIndex,\n  } = props\n\n  const prefersDark = usePrefersDark()\n\n  const [\n    {\n      contextMenu,\n      dragInsertPosition,\n      dragShowMinimap,\n      dragShowMinimapPrompt,\n      dragSkeleton,\n      elements,\n      isDragging,\n      perspective,\n      wasMaybeCollapsed,\n      dragMinimapTransition,\n      dragGroupRect,\n    },\n    dispatch,\n  ] = useReducer(overlayStateReducer, {\n    contextMenu: null,\n    dragInsertPosition: null,\n    dragShowMinimap: false,\n    dragShowMinimapPrompt: false,\n    dragSkeleton: null,\n    elements: [],\n    focusPath: '',\n    isDragging: false,\n    perspective: 'published',\n    wasMaybeCollapsed: false,\n    dragMinimapTransition: false,\n    dragGroupRect: null,\n  })\n  const [rootElement, setRootElement] = useState<HTMLElement | null>(null)\n  const [overlayEnabled, setOverlayEnabled] = useState(true)\n\n  useEffect(() => {\n    const unsubs = [\n      comlink?.on('presentation/focus', (data) => {\n        dispatch({type: 'presentation/focus', data})\n      }),\n      comlink?.on('presentation/blur', (data) => {\n        dispatch({type: 'presentation/blur', data})\n      }),\n      comlink?.on('presentation/toggle-overlay', () => {\n        setOverlayEnabled((enabled) => !enabled)\n      }),\n    ].filter(Boolean)\n\n    return () => unsubs.forEach((unsub) => unsub!())\n  }, [comlink])\n\n  usePerspectiveSync(comlink, dispatch)\n\n  useReportDocuments(comlink, elements, perspective)\n\n  const updateDragPreviewCustomProps = useCallback(\n    (x: number, y: number) => {\n      if (!rootElement) return\n\n      rootElement.style.setProperty('--drag-preview-x', `${x}px`)\n      rootElement.style.setProperty('--drag-preview-y', `${y - window.scrollY}px`)\n    },\n    [rootElement],\n  )\n\n  useEffect(() => {\n    const handleClick = (event: MouseEvent) => {\n      const target = event.target\n\n      // We only need to modify the default behavior if the target is a link\n      const targetsLink = Boolean(\n        isHTMLAnchorElement(target) || (isHTMLElement(target) && target.closest('a')),\n      )\n\n      if (targetsLink && event.altKey) {\n        event.preventDefault()\n        event.stopPropagation()\n        const newEvent = new MouseEvent(event.type, {\n          ...event,\n          altKey: false,\n          bubbles: true,\n          cancelable: true,\n        })\n        event.target?.dispatchEvent(newEvent)\n      }\n    }\n\n    const handleKeyUp = (e: KeyboardEvent) => {\n      if (isAltKey(e)) {\n        setOverlayEnabled((enabled) => !enabled)\n      }\n    }\n\n    const handleKeydown = (e: KeyboardEvent) => {\n      if (isAltKey(e)) {\n        setOverlayEnabled((enabled) => !enabled)\n      }\n\n      if (isHotkey(['mod', '\\\\'], e)) {\n        setOverlayEnabled((enabled) => !enabled)\n      }\n    }\n\n    window.addEventListener('click', handleClick)\n    window.addEventListener('keydown', handleKeydown)\n    window.addEventListener('keyup', handleKeyUp)\n\n    return () => {\n      window.removeEventListener('click', handleClick)\n      window.removeEventListener('keydown', handleKeydown)\n      window.removeEventListener('keyup', handleKeyUp)\n    }\n  }, [setOverlayEnabled])\n\n  const [overlaysFlash, setOverlaysFlash] = useState(false)\n  const [fadingOut, setFadingOut] = useState(false)\n  const fadeOutTimeoutRef = useRef<NodeJS.Timeout | undefined>(undefined)\n\n  // Flash overlays when they are enabled\n  useEffect(() => {\n    if (overlayEnabled) {\n      return raf2(() => {\n        setOverlaysFlash(true)\n        raf2(() => {\n          setFadingOut(true)\n          fadeOutTimeoutRef.current = setTimeout(() => {\n            setFadingOut(false)\n            setOverlaysFlash(false)\n          }, 1500)\n        })\n      })\n    } else if (fadeOutTimeoutRef.current) {\n      clearTimeout(fadeOutTimeoutRef.current)\n      setOverlaysFlash(false)\n      setFadingOut(false)\n    }\n\n    return\n  }, [overlayEnabled])\n\n  const documentIds = useMemo(() => {\n    return elements.flatMap((element) => ('id' in element.sanity ? [element.sanity.id] : []))\n  }, [elements])\n\n  const closeContextMenu = useCallback(() => {\n    dispatch({type: 'overlay/blur'})\n  }, [])\n\n  const optimisticActorReady = useOptimisticActorReady()\n\n  const componentResolver = useMemo(() => {\n    return optimisticActorReady ? _componentResolver : undefined\n  }, [_componentResolver, optimisticActorReady])\n\n  const elementsToRender = useMemo(() => {\n    if (((inFrame || inPopUp) && comlinkStatus !== 'connected') || isDragging) {\n      return []\n    }\n\n    return elements\n      .filter((e) => e.activated || e.focused)\n      .map(({id, element, focused, hovered, rect, sanity, dragDisabled}) => {\n        const draggable =\n          !dragDisabled &&\n          !!element.getAttribute('data-sanity') &&\n          optimisticActorReady &&\n          elements.some((e) =>\n            'id' in e.sanity && 'id' in sanity\n              ? sanityNodesExistInSameArray(e.sanity, sanity) && e.sanity.path !== sanity.path\n              : false,\n          )\n\n        return (\n          <ElementOverlay\n            componentResolver={componentResolver}\n            element={element}\n            enableScrollIntoView={!isDragging && !dragMinimapTransition && !dragShowMinimap}\n            key={id}\n            focused={focused}\n            hovered={hovered}\n            node={sanity}\n            rect={rect}\n            // When inside a popup window we want actions to show up on hover, but iframes should hide them\n            showActions={!inFrame}\n            draggable={draggable}\n            isDragging={isDragging || dragMinimapTransition}\n            wasMaybeCollapsed={focused && wasMaybeCollapsed}\n          />\n        )\n      })\n  }, [\n    componentResolver,\n    dragMinimapTransition,\n    dragShowMinimap,\n    elements,\n    inFrame,\n    inPopUp,\n    isDragging,\n    optimisticActorReady,\n    comlinkStatus,\n    wasMaybeCollapsed,\n  ])\n\n  return (\n    <TelemetryProvider comlink={comlink}>\n      <ThemeProvider scheme={prefersDark ? 'dark' : 'light'} theme={studioTheme} tone=\"transparent\">\n        <LayerProvider>\n          <PortalProvider element={rootElement}>\n            <SchemaProvider comlink={comlink} elements={elements}>\n              <PreviewSnapshotsProvider comlink={comlink}>\n                <SharedStateProvider comlink={comlink}>\n                  <Root\n                    data-fading-out={fadingOut ? '' : undefined}\n                    data-overlays={overlaysFlash ? '' : undefined}\n                    ref={setRootElement}\n                    $zIndex={zIndex}\n                  >\n                    <DocumentReporter documentIds={documentIds} perspective={perspective} />\n                    <OverlaysController\n                      comlink={comlink}\n                      dispatch={dispatch}\n                      inFrame={inFrame}\n                      inPopUp={inPopUp}\n                      onDrag={updateDragPreviewCustomProps}\n                      overlayEnabled={overlayEnabled}\n                      rootElement={rootElement}\n                    />\n                    {contextMenu && <ContextMenu {...contextMenu} onDismiss={closeContextMenu} />}\n                    {elementsToRender}\n\n                    {isDragging && !dragMinimapTransition && (\n                      <>\n                        {dragInsertPosition && (\n                          <OverlayDragInsertMarker dragInsertPosition={dragInsertPosition} />\n                        )}\n                        {dragShowMinimapPrompt && <OverlayMinimapPrompt />}\n                        {dragGroupRect && <OverlayDragGroupRect dragGroupRect={dragGroupRect} />}\n                      </>\n                    )}\n                    {isDragging && dragSkeleton && <OverlayDragPreview skeleton={dragSkeleton} />}\n                  </Root>\n                </SharedStateProvider>\n              </PreviewSnapshotsProvider>\n            </SchemaProvider>\n          </PortalProvider>\n        </LayerProvider>\n      </ThemeProvider>\n    </TelemetryProvider>\n  )\n}\n\nconst IS_MAC =\n  typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform)\n\nconst MODIFIERS: Record<string, 'altKey' | 'ctrlKey' | 'metaKey' | 'shiftKey'> = {\n  alt: 'altKey',\n  ctrl: 'ctrlKey',\n  mod: IS_MAC ? 'metaKey' : 'ctrlKey',\n  shift: 'shiftKey',\n}\nfunction isHotkey(keys: string[], event: KeyboardEvent): boolean {\n  return keys.every((key) => {\n    if (MODIFIERS[key]) {\n      return event[MODIFIERS[key]]\n    }\n    return event.key === key.toUpperCase()\n  })\n}\nfunction isAltKey(event: KeyboardEvent): boolean {\n  return event.key === 'Alt'\n}\n","import {useEffect, useRef, type FunctionComponent} from 'react'\nimport type {VisualEditingNode, VisualEditingOptions} from '../types'\n\n/**\n * @internal\n */\nexport const Refresh: FunctionComponent<\n  {\n    comlink: VisualEditingNode\n  } & Required<Pick<VisualEditingOptions, 'refresh'>>\n> = (props) => {\n  const {comlink, refresh} = props\n\n  const manualRefreshRef = useRef(0)\n  const mutationRefreshRef = useRef(0)\n\n  useEffect(\n    () =>\n      comlink.on('presentation/refresh', (data) => {\n        if (data.source === 'manual') {\n          clearTimeout(manualRefreshRef.current)\n          const promise = refresh(data)\n          if (promise === false) return\n          comlink.post('visual-editing/refreshing', data)\n          let timedOut = false\n          manualRefreshRef.current = window.setTimeout(() => {\n            comlink.post('visual-editing/refreshed', data)\n            timedOut = true\n          }, 3000)\n          promise?.finally?.(() => {\n            if (timedOut) return\n            clearTimeout(manualRefreshRef.current)\n            comlink.post('visual-editing/refreshed', data)\n          })\n        } else if (data.source === 'mutation') {\n          clearTimeout(mutationRefreshRef.current)\n          const promise = refresh(data)\n          if (promise === false) return\n          comlink.post('visual-editing/refreshing', data)\n          // Send an additional refresh to account for Content Lake eventual consistency\n          mutationRefreshRef.current = window.setTimeout(() => {\n            const promise = refresh(data)\n            if (promise === false) return\n            comlink.post('visual-editing/refreshing', data)\n            promise?.finally?.(() => {\n              comlink.post('visual-editing/refreshed', data)\n            }) || comlink.post('visual-editing/refreshed', data)\n          }, 1000)\n          promise?.finally?.(() => {\n            comlink.post('visual-editing/refreshed', data)\n          }) || comlink.post('visual-editing/refreshed', data)\n        }\n      }),\n    [comlink, refresh],\n  )\n\n  return null\n}\n","import {createNode, createNodeMachine, type Status} from '@sanity/comlink'\nimport {\n  createCompatibilityActors,\n  type VisualEditingControllerMsg,\n  type VisualEditingNodeMsg,\n} from '@sanity/presentation-comlink'\nimport {useEffect, useState} from 'react'\nimport type {VisualEditingNode} from '../types'\n\n/**\n * Hook for maintaining a channel between overlays and the presentation tool\n * @internal\n */\nexport function useComlink(active: boolean = true): [VisualEditingNode | undefined, Status] {\n  const [node, setNode] = useState<VisualEditingNode>()\n  const [status, setStatus] = useState<Status>('idle')\n\n  useEffect(() => {\n    if (!active) return\n    const instance = createNode<VisualEditingNodeMsg, VisualEditingControllerMsg>(\n      {\n        name: 'visual-editing',\n        connectTo: 'presentation',\n      },\n      createNodeMachine<VisualEditingNodeMsg, VisualEditingControllerMsg>().provide({\n        actors: createCompatibilityActors<VisualEditingNodeMsg>(),\n      }),\n    )\n    const unsub = instance.onStatus(() => setStatus('connected'), 'connected')\n\n    setNode(instance)\n    const stop = instance.start()\n\n    return () => {\n      unsub()\n      stop()\n      setNode(undefined)\n    }\n  }, [active])\n\n  return [node, status]\n}\n","import {type ListenEvent} from '@sanity/client'\nimport {merge, ReplaySubject, Subject, type Observable, type ObservedValueOf} from 'rxjs'\nimport type {VisualEditingNode} from '../../types'\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype SharedListenEvent = ListenEvent<Record<string, any>>\n\n/**\n * Creates a single, shared, listener EventSource that strems remote mutations, and notifies when it's online (welcome), offline (reconnect).\n */\nexport function createSharedListener(comlink: VisualEditingNode): Observable<SharedListenEvent> {\n  // Welcome events could be received before the listener has been subscribed\n  // to. Using a ReplaySubject will ensure the welcome event is re-emitted when\n  // a new subscriber arrives.\n  const incomingConnection$ = new ReplaySubject<SharedListenEvent>(1)\n  const incomingMutations$ = new Subject<SharedListenEvent>()\n\n  comlink\n    .fetch('visual-editing/snapshot-welcome', undefined, {suppressWarnings: true})\n    .then((data) => {\n      incomingConnection$.next(data.event)\n    })\n    .catch(() => {\n      // Fail silently as the app may be communicating with a version of\n      // Presentation that does not support this feature\n    })\n\n  comlink.on('presentation/snapshot-event', (data) => {\n    // Welcome events are still emitted by Presentation for backwards\n    // compatibility. We don't need them anymore as we explicitly fetch the\n    // welcome event, so filter them out here.\n    if (data.event.type === 'reconnect') {\n      incomingConnection$.next(data.event)\n    }\n    if (data.event.type === 'mutation') {\n      incomingMutations$.next(data.event)\n    }\n  })\n\n  return merge(incomingConnection$, incomingMutations$)\n}\n\nexport type SharedListenerEvents = ObservedValueOf<ReturnType<typeof createSharedListener>>\n","import {useEffect} from 'react'\nimport {createActor} from 'xstate'\nimport {setActor} from '../optimistic/context'\nimport {createSharedListener} from '../optimistic/state/createSharedListener'\nimport {createDatasetMutator} from '../optimistic/state/datasetMutator'\nimport type {VisualEditingNode} from '../types'\n\n/**\n * Hook for maintaining a channel between overlays and the presentation tool\n * @internal\n */\nexport function useDatasetMutator(comlink: VisualEditingNode | undefined): void {\n  useEffect(() => {\n    if (!comlink) return\n    const listener = createSharedListener(comlink)\n    const datasetMutator = createDatasetMutator(comlink)\n    const mutator = createActor(datasetMutator, {\n      // @ts-expect-error @todo\n      input: {client: {withConfig: () => {}}, sharedListener: listener},\n    })\n\n    mutator.start()\n\n    // Fetch features to determine if optimistic updates are supported\n    const featuresFetch = new AbortController()\n    comlink\n      .fetch('visual-editing/features', undefined, {\n        signal: featuresFetch.signal,\n        suppressWarnings: true,\n      })\n      .then((data) => {\n        if (data.features['optimistic']) {\n          setActor(mutator)\n        }\n      })\n      .catch(() => {\n        // eslint-disable-next-line no-console\n        console.warn(\n          '[@sanity/visual-editing] Package version mismatch detected: Please update your Sanity studio to prevent potential compatibility issues.',\n        )\n      })\n\n    return () => {\n      mutator.stop()\n      featuresFetch.abort()\n    }\n  }, [comlink])\n}\n","import {isMaybePreviewIframe, isMaybePreviewWindow} from '@sanity/presentation-comlink'\nimport {useEffect, useState} from 'react'\nimport {createPortal} from 'react-dom'\nimport type {VisualEditingOptions} from '../types'\nimport {History} from './History'\nimport {Meta} from './Meta'\nimport {Overlays} from './Overlays'\nimport {Refresh} from './Refresh'\nimport {useComlink} from './useComlink'\nimport {useDatasetMutator} from './useDatasetMutator'\n\n/**\n * @public\n */\nexport const VisualEditing = (props: VisualEditingOptions & {portal: boolean}): React.ReactNode => {\n  const {components, history, portal = true, refresh, zIndex} = props\n\n  const [inFrame, setInFrame] = useState<boolean | null>(null)\n  const [inPopUp, setInPopUp] = useState<boolean | null>(null)\n  useEffect(() => {\n    setInFrame(isMaybePreviewIframe())\n    setInPopUp(isMaybePreviewWindow())\n  }, [])\n\n  const [portalElement, setPortalElement] = useState<HTMLElement | null>(null)\n  useEffect(() => {\n    if (portal === false) return undefined\n    const node = document.createElement('sanity-visual-editing')\n    document.documentElement.appendChild(node)\n    setPortalElement(node)\n    return () => {\n      setPortalElement(null)\n      if (document.documentElement.contains(node)) {\n        document.documentElement.removeChild(node)\n      }\n    }\n  }, [portal])\n\n  const [comlink, comlinkStatus] = useComlink(inFrame === true || inPopUp === true)\n  useDatasetMutator(comlinkStatus === 'connected' ? comlink : undefined)\n\n  const children = (\n    <>\n      {inFrame !== null && inPopUp !== null && (\n        <Overlays\n          comlink={comlink}\n          comlinkStatus={comlinkStatus}\n          componentResolver={components}\n          inFrame={inFrame}\n          inPopUp={inPopUp}\n          zIndex={zIndex}\n        />\n      )}\n      {comlink && (\n        <>\n          <History comlink={comlink} history={history} />\n          <Meta comlink={comlink} />\n          {refresh && <Refresh comlink={comlink} refresh={refresh} />}\n        </>\n      )}\n    </>\n  )\n\n  if (portal === false || !portalElement) return children\n\n  return createPortal(children, portalElement)\n}\nVisualEditing.displayName = 'VisualEditing'\n"],"names":["History","props","$","_c","comlink","history","t0","t1","on","data","update","useEffect","t2","t3","subscribe","title","document","post","Meta","sendMeta","observer","MutationObserver","mutation","target","nodeName","observe","head","subtree","characterData","childList","disconnect","getReferenceNodeAndInsertPosition","position","top","right","bottom","left","node","sanity","useDragEndEvents","getDocument","useDocuments","handler","e","insertPosition","preventInsertDefault","detail","reference","doc","id","key","targetKey","hasExplicitKey","getArrayItemKeyAndParentPath","path","arrayPath","referenceItemKey","patch","getSnapshot","snapshot","elementValue","getFromPath","at","remove","_key","insert","window","addEventListener","removeEventListener","dispatchDragEndEvent","_temp","Symbol","for","event","customEvent","CustomEvent","cancelable","dispatchEvent","SchemaContext","createContext","useSchema","context","useContext","Error","getArrayRemoveAction","type","getArrayRemovePatches","getArrayInsertAction","insertType","getArrayInsertPatches","getDuplicateAction","getArrayDuplicatePatches","getContextMenuItems","field","parent","getContextMenuArrayItems","getContextMenuUnionItems","Promise","resolve","getDuplicateItem","label","icon","CopyIcon","action","telemetryEvent","getRemoveItems","RemoveIcon","getMoveItems","withDivider","items","groupItems","moveUpPatches","moveDownPatches","moveFirstPatches","moveLastPatches","all","getArrayMovePatches","length","push","PublishIcon","ArrowUpIcon","ArrowDownIcon","UnpublishIcon","SortIcon","InsertAboveIcon","name","InsertBelowIcon","InsertMenuWrapper","width","onSelect","boundaryElement","arrow","constrainSize","floatingBoundary","padding","placement","fallbackPlacements","preventOverflow","__unstable_margins","jsx","InsertMenu","t4","MenuGroup","options","insertMenu","views","some","view","undefined","component","sendTelemetry","schemaType","of","filter","item","map","t","getNodeIcon","POPOVER_MARGINS","ContextMenuItem","onDismiss","useTelemetry","onClick","MenuDivider","hotkeys","MenuItem","t5","itemIndex","Component","ContextMenu","x","y","setBoundaryElement","useState","getField","setItems","fetchContextMenuItems","items_0","t6","getBoundingClientRect","height","contextMenuReferenceElement","t7","t8","t9","minWidth","maxWidth","t10","Box","Text","Spinner","t11","t12","Stack","t13","jsxs","Flex","t14","Fragment","i","t15","Menu","t16","t17","t18","t19","Popover","t20","PopoverPortal","getLinkHref","href","referer","parsed","URL","location","origin","hash","slice","pathname","search","searchParams","set","toString","PreviewSnapshotsContext","usePreviewSnapshots","isReactElementOverlayComponent","isValidElement","Root","styled","Card","Actions","Tab","ActionOpen","Labels","createIntentLink","baseUrl","tool","workspace","createEditUrl","pathToUrlString","studioPath","fromString","ElementOverlayInner","element","focused","componentResolver","showActions","draggable","getType","previewSnapshots","bb0","find","_id","bb1","value","componentContext","customComponents","useCustomComponents","__html","DocumentIcon","DragHandleIcon","Array","isArray","props_0","PointerEvents","ElementOverlay","memo","hovered","rect","wasMaybeCollapsed","enableScrollIntoView","ref","useRef","scrolledIntoViewRef","w","h","transform","style","current","scrollIntoView","behavior","actions","block","inline","scrollMode","isNearTop","setIsNearTop","io","IntersectionObserver","intersection","boundingClientRect","threshold","resolved","Link","useSyncExternalStore","_temp2","_temp3","onStoreChange","handlePopState","OverlayDragGroupRect","dragGroupRect","border","pointerEvents","lerp","v0","v1","OverlayDragInsertMarker","dragInsertPosition","flow","offsetMultiplier","markerThickness","startX","endX","offset","Math","min","startY","endY","max","background","borderRadius","zIndex","div","$scaleFactor","$width","$height","clamp","number","inMin","inMax","outMin","outMax","mapped","OverlayDragPreview","skeleton","maxSkeletonWidth","innerWidth","scaleFactor","offsetX","offsetY","prefersDark","usePrefersDark","theme","useTheme_v2","radius","childRects","imageRects","textRects","color","from","r_1","r","tagName","r_0","OverlayMinimapPrompt","Hotkeys","ExpandIcon","elementsReducer","elements","message","activated","dragDisabled","clickedElement","overlayStateReducer","state","contextMenu","focusPath","perspective","isDragging","dragShowMinimap","dragShowMinimapPrompt","dragSkeleton","dragMinimapTransition","prevFocusPath","startsWith","display","groupRect","PreviewSnapshotsProvider","children","setPreviewSnapshots","signal","response","fetch","suppressWarnings","snapshots","fetchPreviewSnapshots","previewSapshotsFetch","AbortController","unsub","onStatus","abort","isSanityNode","isDocumentSchemaType","isTypeSchemaType","popUnkeyedPathSegments","split","toReversed","reduce","acc","part","includes","join","getPathsWithUnresolvedTypes","SchemaProvider","Map","resolvedTypes","setResolvedTypes","schema","setSchema","fetchSchema","schemaFetch","reportedPathsRef","reportPaths","paths","signal_0","response_0","types","controller","paths_0","p","_type","node_0","schemaType_0","fieldFromPath","schemaType_1","path_0","prevPath","next","rest","objectField","fields","name_0","get","Boolean","type_0","nodePath","flatMap","console","warn","createStore","initialState","getState","listeners","Set","setState","fn","forEach","l","listener","add","delete","store","SharedStateProvider","catch","value_0","SharedStateContext","prev","prev_0","Object","fromEntries","entries","reason","debug","TelemetryProvider","events","log","TelemetryContext","useController","inFrame","inPopUp","overlayController","optimisticActorReady","useOptimisticActorReady","createOverlayController","overlayElement","destroy","usePerspectiveSync","dispatch","then","data_0","isEqualSets","a","b","size","has","useReportDocuments","lastReported","documents","perspective_0","reportDocuments","nodes","nodeIds","documentsOnPage","projectId","_projectId","dataset","_dataset","e_0","s","$zIndex","raf2","r0","r1","requestAnimationFrame","cancelAnimationFrame","DocumentReporter","documentIds","uniqueIds","setUniqueIds","prevId","actor","useOptimisticActor","send","documentId","getDraftId","getPublishedId","OverlaysController","onDrag","overlayEnabled","rootElement","enabled","dragGroup","cursor","removeProperty","activate","deactivate","Overlays","comlinkStatus","_componentResolver","useReducer","setRootElement","setOverlayEnabled","unsubs","setProperty","scrollY","updateDragPreviewCustomProps","handleClick","handleKeyUp","isAltKey","_temp4","handleKeydown","_temp5","isHotkey","_temp6","overlaysFlash","setOverlaysFlash","fadingOut","setFadingOut","fadeOutTimeoutRef","setTimeout","clearTimeout","_temp7","closeContextMenu","_temp8","element_0","getAttribute","e_2","sanityNodesExistInSameArray","elementsToRender","t21","t22","t23","t24","t25","t26","LayerProvider","PortalProvider","t27","ThemeProvider","studioTheme","t28","IS_MAC","test","navigator","platform","MODIFIERS","alt","ctrl","mod","shift","keys","every","toUpperCase","isHTMLAnchorElement","isHTMLElement","closest","altKey","preventDefault","stopPropagation","newEvent","MouseEvent","bubbles","enabled_0","enabled_1","enabled_2","e_1","Refresh","refresh","manualRefreshRef","mutationRefreshRef","source","promise","timedOut","finally","promise_0","promise_1","useComlink","active","setNode","status","setStatus","instance","createNode","connectTo","createNodeMachine","provide","actors","createCompatibilityActors","stop","start","createSharedListener","incomingConnection$","ReplaySubject","incomingMutations$","Subject","merge","useDatasetMutator","datasetMutator","createDatasetMutator","mutator","createActor","input","client","withConfig","sharedListener","featuresFetch","features","optimistic","setActor","VisualEditing","components","portal","setInFrame","setInPopUp","isMaybePreviewIframe","isMaybePreviewWindow","portalElement","setPortalElement","createElement","documentElement","appendChild","contains","removeChild","createPortal","displayName"],"mappings":"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"}